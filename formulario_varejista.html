<!-- BLOQUEIO DE FORNECEDORES -->
<h3 style="margin-top: 40px; color: #0055ff;">ðŸ”’ Fornecedores Cadastrados</h3>
<div id="listaFornecedores"></div>

<script>
  function carregarFornecedores() {
    const lista = document.getElementById("listaFornecedores");
    lista.innerHTML = "<p>Carregando...</p>";

    firebase.database().ref("fornecedores").once("value").then(snapshot => {
      let html = "<table border='1' width='100%' style='margin-top: 15px;'><tr><th>RazÃ£o Social</th><th>CNPJ</th><th>Status</th><th>ObservaÃ§Ã£o</th><th>AÃ§Ã£o</th></tr>";
      snapshot.forEach(f => {
        const dados = f.val();
        const status = dados.status || "ATIVO";
        const obs = dados.observacao || "";
        html += `<tr>
          <td>${dados.razaoSocial}</td>
          <td>${dados.cnpj}</td>
          <td>${status}</td>
          <td><input type="text" id="obs_${f.key}" value="${obs}" maxlength="125" style="width: 100%;"></td>
          <td>
            <button onclick="bloquearFornecedor('${f.key}')">Bloquear</button>
          </td>
        </tr>`;
      });
      html += "</table>";
      lista.innerHTML = html;
    });
  }

  function bloquearFornecedor(cod) {
    const obs = document.getElementById("obs_" + cod).value;
    firebase.database().ref("fornecedores/" + cod).update({
      status: "BLOQUEADO",
      observacao: obs
    }).then(() => {
      alert("Fornecedor bloqueado com sucesso!");
      carregarFornecedores();
    });
  }

  window.onload = carregarFornecedores;
</script>
